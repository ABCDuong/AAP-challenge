<!doctype html>
<html>

<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
        rel="stylesheet">
  <link href="./styles/tailwind.css"
        rel="stylesheet">
  <link href="./styles/custom.css"
        rel="stylesheet">

  <script src="shared/constants.js"></script>
  <script src="./shared/dropdownBehavior.js"></script>
  <script src="./main.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js"
          defer></script>
</head>

<body>
  <div x-data="{...petListings(), ...dropdownBehavior()}"
       x-init="getPetList()"
       class="p-6 md:p-8 lg:p-12 xl:p-20 2xl:p-24">
    <template x-if="isLoading">
      <div class="block m-auto w-fit-content">
        <div class="flex flex-col">
          <div class="lds-roller">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
          </div>

          <span class="text-center color-4D font-semibold tracking-wide">
            Loading...
          </span>
        </div>
      </div>
    </template>

    <!-- dropdown -->
    <template x-if="!isLoading">
      <div x-spread="wrapper"
           class="relative ml-4
                  md:w-96">
        <div x-spread="trigger"
             class="dropdown relative
             p-4 cursor-pointer
             md:w-96 
             sm:h-14 h-12
             border border-solid rounded-md border-gray-b3">
          <div x-text="selectedPetListState"
               class="absolute
               top-1/2 -transformy-1/2">
          </div>

          <template x-if="!open">
            <span class="material-icons
            absolute
            top-1/2 -transformy-1/2 right-4">
              arrow_drop_down
            </span>
          </template>

          <template x-if="open">
            <span class="material-icons
                  absolute
                  top-1/2 -transformy-1/2 right-4">
              arrow_drop_up
            </span>
          </template>
        </div>

        <div class="py-2 mt-2.5 z-50
             absolute
             md:w-96
             bg-white
             border border-solid rounded-md border-gray-b3 shadow-md"
             :class="{ 'hidden': !open }">
          <template x-for="state of petListingState"
                    :key="state">
            <div x-spread="menu"
                 x-on:click="setPetListFilter(state)"
                 class="px-5
                 hover:bg-gray-200 cursor-pointer">
              <span x-text="state"
                    class="leading-10">
              </span>
            </div>
          </template>
        </div>
      </div>
    </template>

    <template x-if="isFiltering">
      <div class="block m-auto w-fit-content">
        <div class="flex flex-col">
          <div class="lds-roller">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
          </div>

          <span class="text-center color-4D font-semibold tracking-wide">
            Loading...
          </span>
        </div>
      </div>
    </template>

    <!-- listing container -->
    <template x-if="!isFiltering">
      <div class="mt-10
                  md:flex md:flex-wrap md:justify-start">
        <template x-if="!isLoading">
          <template x-for="pet in petListFiltered"
                    :key="pet">
            <!-- pet card -->
            <div class="m-4 relative
                        bg-white shadow-md
                        flex flex-row
                        md:w-56 lg:w-96
                        md:flex md:flex-col">
              <!-- small-screen heart/info icons -->
              <div class="small-screen-card-icons absolute right-2 top-4">
                <div class="small-screen-card-icons absolute">
                  <div class="cursor-pointer">
                    <img src="images/favorite-over-white.svg"
                         alt="favorite">
                  </div>

                  <div class="transformx-1/4-rem cursor-pointer">
                    <img src="images/info-over-white.svg"
                         alt="info">
                  </div>
                </div>
              </div>

              <!-- image section/container -->
              <div class="relative sm:w-5/12 md:w-full w-5/12">
                <img :src="`${pet.large_results_photo_url}`"
                     width="100%">

                <div class="absolute bottom-0 left-1/2 -transformx-1/2
                            w-full
                            font-bold text-center">
                  <template x-if="pet.details.act_quickly === 1">
                    <div class="block bg-yellow-FFCC1B py-1">
                      <span x-text="petInfoAlert.act_quickly"></span>
                    </div>
                  </template>

                  <template x-if="pet.details.adopted === 1">
                    <div class="block bg-blue-00BFDA text-white py-1">
                      <span x-text="petInfoAlert.adopted"></span>
                    </div>
                  </template>
                </div>

                <!-- heart/info icons -->
                <div class="card-icons absolute right-4 top-4">
                  <div class="cursor-pointer">
                    <img src="images/favorite.svg"
                         alt="favorite">
                  </div>

                  <div class="transformx-1/4-rem cursor-pointer">
                    <img src="images/info.svg"
                         alt="more-info">
                  </div>
                </div>
              </div>

              <div class="p-4 sm:pb-4 lg:pb-8
                          flex flex-col">
                <span x-text="pet.pet_name"
                      class="sm:text-lg md:text-2xl lg:text-3xl text-blue-00bfda font-extrabold">
                </span>

                <div class="sm:text-md md:text-lg lg:text-xl
                            w-11/12 md:w-full
                            text-gray-24 font-bold">
                  <p class="whitespace-nowrap truncate">
                    <span x-text="pet.primary_breed"></span>

                    <template x-if="pet.secondary_breed">
                      <span>
                        <span>/</span>
                        <span x-text="pet.secondary_breed">
                        </span>
                      </span>
                    </template>
                  </p>
                </div>

                <div
                     class="mt-4 flex flex-row flex-wrap sm:text-md md:text-lg lg:text-xl">
                  <div class="flex flex-row flex-wrap">
                    <span x-text="pet.age"
                          class="text-gray-24 font-light capitalize">
                    </span>

                    <span>,&nbsp;</span>
                    <span x-text="gender[pet.sex]"
                          class="text-gray-24 font-light capitalize">
                    </span>

                    <template x-if="pet.details.special_needs === 1">
                      ,&nbsp;
                      <span x-text="petInfoAlert.special_needs"
                            class="text-red-500">
                      </span>
                    </template>

                    <template x-if="pet.details.bonded_pair === 1">
                      ,&nbsp;
                      <span x-text="petInfoAlert.bonded_pair"
                            class="text-red-500">
                      </span>
                    </template>
                  </div>
                </div>

                <div class="flex flex-row flex-nowrap
                            sm:text-md md:text-lg lg:text-xl
                            text-gray-24 font-light">
                  <span x-text="pet.addr_city"
                        class="capitalize">
                  </span>
                  <span class="flex items-end">,&nbsp;</span>
                  <span x-text="pet.addr_state_code"
                        class="uppercase">
                  </span>
                </div>
              </div>
            </div>
          </template>
        </template>
      </div>
    </template>
  </div>
</body>

</html>
